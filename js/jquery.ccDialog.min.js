(function(h,m,k){var b=function(a,d){this.settings=h.extend({},b.defaults,d||{});var c=b.util.createMask(this.settings),e=b.util.createDialog(a,this.settings);this.hash={mask:c,dialog:e,index:p++};this.events=h.extend({},b.events)};b.defaults={msg:"111",skin:"ccdefault",maskid:"ccDialogMask",method:"iframe",cctitle:"\u5bf9\u8bdd\u6846",w:400,h:300,closeTrigger:".ccbar a.ccclose"};b.events={onhide:null};var n=!1,p=1,l=/{(\w*?)}/ig;mystack=[];m.ccDialogStack={push:function(a){mystack.push(a)},pop:function(){return mystack.pop()},
top:function(){var a=mystack.length;return 0<a?mystack[a-1]:k}};b.util={createMask:function(a){if(n)return this.getObj(b.defaults.maskid);var d='<div id="{maskid}" class="ccmask {skin}"><iframe src="about:blank" frameborder="0" style="width:100%; height:100%; display:none; _display:block;"></iframe></div>'.replace(l,function(d,b){return a[b]});n=!0;return h(d).appendTo("body")},showMask:function(a){a=a.hash;a.mask.css({"z-index":10*a.index}).show()},hideMask:function(a){a.hash.mask.hide()},generateDialog:function(){var a=
[];a.push('<div class="{skin}">');a.push('<div id="{id}" class="ccdialog">');a.push('<div class="ccbar"><span class=\'cctitle\' title="{cctitle}">{cctitle}</span><a href="javascript:void(0);" class="ccclose" title="\u5173\u95ed"></a></div>');a.push('<div class="cccontent">{content}</div>  </div>  </div>');return a.join("")},createDialog:function(a,d){var c;switch(d.method){case "iframe":c=this.createIframeDialog(a,d);break;case "wrap":c=this.createWrapDialog(a,d);break;default:this.error("createDialog Error:Method "+
d.method+" does not exist on jQuery.ccDialog!");return}return c},createIframeDialog:function(a,d){var c;c=this.generateDialog();c=c.replace(l,function(c,b){switch(b){case "id":return a;case "content":return'<div><iframe id="{id}_ifrDialog" name="{id}_ifrDialog" src="about:blank" frameborder="0" scrolling="auto" style="width:100%; height:100%;"></iframe></div>;';default:return d[b]?d[b]:""}});return _dialog=h(c).appendTo("body").find("#"+a)},createWrapDialog:function(a,d){var c=this.generateID(a);
_dialogHTML=this.generateDialog();_dialogHTML=_dialogHTML.replace(l,function(a,b){switch(b){case "id":return c;case "content":return"";default:return d[b]?d[b]:""}});_dialog=h(_dialogHTML).appendTo("body").find("#"+c);_dialog.find("div.cccontent").append(this.getObj(a).show());return _dialog},showDialog:function(a,d,b,e,f){var g=f.hash,h=g.dialog,g=g.index,k=this;this.resizeDialog(b,e,f);b=h.find("iframe");0<b.length&&b.attr("src",a);h.find("a.ccclose").off("click").on("click",function(a){k.hide(f);
return!1}).end().find("div.ccbar .cctitle").html(d).end().css({index:10*g+1}).show()},hideDialog:function(a,b){a.hash.dialog.hide()},resizeDialog:function(a,b,c){var e=c.hash.dialog,f;b+=this.getBarHeight(c);c=0-Math.floor(b/2);f=0-Math.floor(a/2);e=e.width(a).height(b).css({"margin-top":c,"margin-left":f}).find("iframe");0<e.length&&e.width(a).height(b)},show:function(a,b,c,e,f){this.showMask(f);this.showDialog(a,b,c,e,f);ccDialogStack.push(f)},hide:function(a,b){var c=a.events;this.hideMask(a);
this.hideDialog(a);ccDialogStack.pop();c&&"function"===typeof c.onhide&&c.onhide.apply(a,[b])},getBarHeight:function(a){a={ccdefault:26,ccblue:36}[a.settings.skin];return"number"===typeof a?a:0},getObj:function(a){a=["#",a].join("");return h(a)},generateID:function(a){return[a,"_wrapper"].join("")},error:function(a){alert(a);return!1}};b.prototype.show=function(a,d,c,e,f){switch(this.settings.method){case "iframe":"string"!==typeof a&&(a="about:blank");"string"!==typeof d&&("function"===typeof d?
(f=d,c=b.defaults.w,e=b.defaults.h):"number"===typeof d?(f="function"===typeof e?e:k,e=c,c=d):(c=b.defaults.w,e=b.defaults.h),d=b.defaults.cctitle);break;case "wrap":if(4<arguments.length){b.util.error("show Error:Parameter number error!");return}var g=Array.prototype.slice.call(arguments);"function"===typeof arguments[0]?(f=arguments[0],a=k,d=b.defaults.cctitle,c=b.defaults.w,e=b.defaults.h):"number"===typeof arguments[0]?(f="function"===typeof g[2]?g[2]:k,e="number"===typeof g[1]?g[1]:b.defaults.h,
c=b.defaults.w,d=b.defaults.cctitle,a=k):"string"===typeof arguments[0]?(d=g[0],"function"===typeof g[1]?(f=g[1],a=k,c=b.defaults.w,e=b.defaults.h):"number"===typeof g[1]?(c=g[1],e="number"===typeof g[2]?g[2]:b.defaults.h,f="function"===typeof g[3]?g[3]:k):b.util.error("1show Error:Parameter type error!")):b.util.error("2show Error:Parameter type error!");break;default:b.util.error("show Error:Method "+_settings.method+" does not exist on jQuery.ccDialog!")}b.util.show(a,d,c,e,this);h.extend(this.events,
{onhide:f})};b.prototype.hide=function(a){b.util.hide(this,a)};h.fn.ccDialog={init:function(a,d){return new b(a,h.extend(d,{method:"iframe"}))},wrap:function(a,d){return new b(a,h.extend(d,{method:"wrap"}))},close:function(a){var b=m.parent.ccDialogStack.top();b&&b.hide.apply(b,[a])}}})(jQuery,window);
